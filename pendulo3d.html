<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P√™ndulo 3D Simples</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            overflow: hidden;
            height: 100vh;
        }

        #controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 10;
            min-width: 280px;
        }

        h1 {
            font-size: 22px;
            margin-bottom: 20px;
            color: #00d4ff;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        .control-group {
            margin: 15px 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            color: #aaa;
        }

        .value {
            float: right;
            color: #00d4ff;
            font-weight: bold;
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            background: #333;
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #00d4ff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.7);
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #00d4ff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.7);
            border: none;
        }

        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        #startBtn {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.4);
        }

        #startBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 255, 0.6);
        }

        #resetBtn {
            background: linear-gradient(135deg, #ff6b6b, #cc5555);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        #resetBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }

        .info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 212, 255, 0.1);
            border-left: 3px solid #00d4ff;
            border-radius: 5px;
            font-size: 12px;
            line-height: 1.6;
        }

        canvas {
            display: block;
        }

        @media (max-width: 768px) {
            #controls {
                width: calc(100% - 40px);
                max-width: 350px;
            }
        }
    </style>
</head>

<body>
    <div id="controls">
        <h1>üéØ P√™ndulo 3D</h1>

        <div class="control-group">
            <label>
                Comprimento
                <span class="value" id="lengthValue">3.0 m</span>
            </label>
            <input type="range" id="length" min="1" max="5" step="0.5" value="3">
        </div>

        <div class="control-group">
            <label>
                √Çngulo Inicial
                <span class="value" id="angleValue">45¬∞</span>
            </label>
            <input type="range" id="angle" min="10" max="80" step="5" value="45">
        </div>

        <div class="control-group">
            <label>
                Gravidade
                <span class="value" id="gravityValue">9.8 m/s¬≤</span>
            </label>
            <input type="range" id="gravity" min="1" max="20" step="0.5" value="9.8">
        </div>

        <div class="buttons">
            <button id="startBtn">Iniciar</button>
            <button id="resetBtn">Reiniciar</button>
        </div>

        <div class="info">
            üí° Arraste para girar a c√¢mera<br>
            üñ±Ô∏è Scroll para zoom<br>
            ‚ú® F√≠sica precisa e est√°vel
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // ========== CONFIGURA√á√ÉO DA CENA 3D ==========
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x16213e);

        const camera = new THREE.PerspectiveCamera(
            60,
            window.innerWidth / window.innerHeight,
            0.1,
            1000
        );
        camera.position.set(6, 4, 6);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        // Controles da c√¢mera
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;

        // ========== ILUMINA√á√ÉO ==========
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 10, 5);
        directionalLight.castShadow = true;
        scene.add(directionalLight);

        // ========== GRID DO CH√ÉO ==========
        const gridHelper = new THREE.GridHelper(10, 10, 0x444444, 0x222222);
        scene.add(gridHelper);

        // ========== PONTO DE PIV√î ==========
        const pivotGeometry = new THREE.SphereGeometry(0.15, 16, 16);
        const pivotMaterial = new THREE.MeshStandardMaterial({
            color: 0xcccccc,
            metalness: 0.7,
            roughness: 0.3
        });
        const pivot = new THREE.Mesh(pivotGeometry, pivotMaterial);
        pivot.position.y = 4;
        pivot.castShadow = true;
        scene.add(pivot);

        // ========== ESFERA DO P√äNDULO ==========
        const bobGeometry = new THREE.SphereGeometry(0.25, 32, 32);
        const bobMaterial = new THREE.MeshStandardMaterial({
            color: 0x00d4ff,
            metalness: 0.3,
            roughness: 0.4,
            emissive: 0x0066aa,
            emissiveIntensity: 0.3
        });
        const bob = new THREE.Mesh(bobGeometry, bobMaterial);
        bob.castShadow = true;
        scene.add(bob);

        // ========== CORDA DO P√äNDULO ==========
        const ropeMaterial = new THREE.LineBasicMaterial({
            color: 0xffffff,
            linewidth: 2
        });
        const ropeGeometry = new THREE.BufferGeometry();
        const ropePositions = new Float32Array(6);
        ropeGeometry.setAttribute('position', new THREE.BufferAttribute(ropePositions, 3));
        const rope = new THREE.Line(ropeGeometry, ropeMaterial);
        scene.add(rope);

        // ========== PAR√ÇMETROS DA F√çSICA ==========
        let length = 3.0;
        let gravity = 9.8;
        let angle = 45 * Math.PI / 180;
        let angularVelocity = 0;
        let running = false;

        // ========== ATUALIZAR POSI√á√ÉO DO P√äNDULO ==========
        function updatePendulum() {
            // Posi√ß√£o em coordenadas polares (movimento no plano XY)
            const x = length * Math.sin(angle);
            const y = pivot.position.y - length * Math.cos(angle);
            const z = 0; // Simples, oscila apenas em um plano

            bob.position.set(x, y, z);

            // Atualizar corda
            const positions = rope.geometry.attributes.position.array;
            positions[0] = pivot.position.x;
            positions[1] = pivot.position.y;
            positions[2] = pivot.position.z;
            positions[3] = x;
            positions[4] = y;
            positions[5] = z;
            rope.geometry.attributes.position.needsUpdate = true;
        }

        // ========== F√çSICA DO P√äNDULO ==========
        function updatePhysics(dt) {
            if (!running) return;

            // Equa√ß√£o do p√™ndulo simples: a = -(g/L) * sin(Œ∏)
            const angularAcceleration = -(gravity / length) * Math.sin(angle);

            // Integra√ß√£o de Euler
            angularVelocity += angularAcceleration * dt;
            angle += angularVelocity * dt;

            updatePendulum();
        }

        // ========== CONTROLES DA UI ==========
        document.getElementById('length').addEventListener('input', (e) => {
            length = parseFloat(e.target.value);
            document.getElementById('lengthValue').textContent = length.toFixed(1) + ' m';
            if (!running) updatePendulum();
        });

        document.getElementById('angle').addEventListener('input', (e) => {
            const degrees = parseFloat(e.target.value);
            angle = degrees * Math.PI / 180;
            document.getElementById('angleValue').textContent = degrees + '¬∞';
            if (!running) updatePendulum();
        });

        document.getElementById('gravity').addEventListener('input', (e) => {
            gravity = parseFloat(e.target.value);
            document.getElementById('gravityValue').textContent = gravity.toFixed(1) + ' m/s¬≤';
        });

        document.getElementById('startBtn').addEventListener('click', () => {
            running = !running;
            document.getElementById('startBtn').textContent = running ? 'Pausar' : 'Iniciar';
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            running = false;
            document.getElementById('startBtn').textContent = 'Iniciar';
            angle = parseFloat(document.getElementById('angle').value) * Math.PI / 180;
            angularVelocity = 0;
            updatePendulum();
        });

        // ========== LOOP DE ANIMA√á√ÉO ==========
        let lastTime = performance.now();

        function animate() {
            requestAnimationFrame(animate);

            const currentTime = performance.now();
            const dt = Math.min((currentTime - lastTime) / 1000, 0.02); // Limita dt
            lastTime = currentTime;

            updatePhysics(dt);
            controls.update();
            renderer.render(scene, camera);
        }

        // ========== RESPONSIVIDADE ==========
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // ========== INICIALIZAR ==========
        updatePendulum();
        animate();
    </script>
</body>

</html>